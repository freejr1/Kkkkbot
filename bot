import requests
from telebot import TeleBot
from telebot.types import Message

# Token do bot e ID do grupo autorizado
bot = TeleBot("7862652022:AAG22CFcGrGavgTnMKbWjkq_qAqzVHVKjPo")
ALLOWED_GROUP_ID = -1002607184549

def check_group(message: Message):
    if message.chat.id != ALLOWED_GROUP_ID:
        bot.reply_to(message, "ğŸš« Este grupo nÃ£o estÃ¡ autorizado a usar este bot!")
        return False
    return True

@bot.message_handler(commands=['start'])
def start(message: Message):
    bot.reply_to(message, "ğŸ‘‹ Bem-vindo!\nUse /like <uid> <region> <quantidade> para enviar likes.")

@bot.message_handler(commands=['like'])
def send_likes(message: Message):
    if not check_group(message):
        return
    args = message.text.split()
    if len(args) != 4:
        bot.reply_to(message, "âŒ Formato invÃ¡lido!\nUse: /like <uid> <region> <quantidade>")
        return

    uid, region, count = args[1], args[2], args[3]

    if not uid.isdigit() or not count.isdigit():
        bot.reply_to(message, "âš ï¸ UID e quantidade devem ser nÃºmeros!")
        return

    url = f"https://likes-api-lkteam-v3.onrender.com/like?uid={uid}&region={region}&count={count}"
    try:
        response = requests.get(url, timeout=15)
        if response.status_code == 200:
            bot.reply_to(message, f"â¤ï¸ Likes enviados com sucesso para UID {uid} na regiÃ£o {region}!")
        else:
            bot.reply_to(message, f"âŒ Erro ao enviar likes. CÃ³digo: {response.status_code}")
    except Exception as e:
        bot.reply_to(message, f"âŒ Erro na requisiÃ§Ã£o: {e}")

bot.polling()
